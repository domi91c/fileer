<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>fileer</title>
</head>

<template name="layout">
    <div class="windowed">
        <div class="outer-wrapper">
            <section id="content" class="">
                <div class="container">
                    <div class="logo">fileer</div>
                    <div class="content">
                        <div class="main">
                            <section class="body">
                                {{> yield }}
                            </section>
                        </div>
                    </div>
                </div>
            </section>
            {{> footer }}
        </div>
    </div>
</template>

<template name="index">
    <p class="center">You can share your files with your friends and make a list for your own staff as well</p>
    {{> upload }}
    {{> filelist files=files }}
    {{#if files.count }}
        <div class="center">
            <p>To reach your files afterwards or share them with your friends, keep the address below.</p>
            <div class="btn-group">
                <input class="textinput textInput width600" type="text" value="{{ absoluteUrl  }}{{ pathFor 'download' _uuid=uuid }}">
            </div>
            <div>Total size for <b>{{ files.count }}</b> files is <b>({{ totalsizes files }})</b></div>
        </div>
    {{/if}}
</template>

<template name="filelist">
    {{> error }}
    {{#if files.count }}
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Name</th>
                    <th style="width:100px;">size</th>
                    <th style="width:100px;">extension</th>
                    {{#if link }}
                        <th style="width:100px;">link</th>
                    {{/if}}
                </tr>
            </thead>
            <tbody>
                {{# each files }}
                    {{#with this }}
                        {{#if isUploaded}}
                            <tr>
                                <td>
                                    {{ name }}
                                </td>
                                <td>
                                    {{ humanFileSize size }}
                                </td>
                                <td>
                                    {{ extension }}
                                </td>
                                {{#if ../../link }}
                                    <td>
                                        <a href="{{ this.url }}" target="_blank" >Download</a>
                                    </td>
                                {{/if}}
                            </tr>
                        {{ else }}
                            <img src="/img/loading.svg?{{ randomid }}" class="loading"/>
                        {{/if}}
                    {{/with}}
                {{/each}}
            </tbody>
        </table>
    {{/if}}
</template>

<template name="footer">
    <footer class="center">
        <a href="https://github.com/yasaricli/fileer"> 
            <img src="/img/githublogo.png" class="githublogo"/>
        </a>
        <div class="mt10">
            @author <a href="http://yasaricli.com">yasaricli</a>
        </div> 
    </footer>
</template>

<template name="download">
    <div class="center mb10">
        <div class="btn btn-small">
            <div>Total size for <b>{{ files.count }}</b> files is <b>({{ totalsizes files }})</b></div>
        </div>
    </div>
    {{> filelist files=files link=true }}
</template>

<template name="error">
    {{# if error_message }}
        <div class="error">
            <strong class="text-error center">
                {{# if stack}}
                    {{ error_message }}
                {{ else }}
                    Due to the file size is not 5MB and file extension is not supported, it is not loaded.
                {{/if}}
            </strong>
        </div>
    {{/if}}
</template>

<template name="upload">
    <fieldset class="form-actions center">
        <button type="submit" class="upload-trigger btn btn-primary">Upload Files</button>
        <input type="file" id="Files" class="hidden" multiple>
    </fieldset>
</template>
